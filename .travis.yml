sudo: required

language: elixir
elixir:
 - 1.8.1

otp_release:
 - 21.2.5

addons:
  postgresql: '10.6'

script:
 - mix local.rebar --force
 - mix local.hex --force
 - mix deps.get

after_script:
 - mix do ecto.create, ecto.migrate
 - mix test


deploy:
  provider: heroku
  app: shorten-url-ba
  api_key:
    secure: cp6UvSBJLRS1YPXyBQswK4w76vZzxffHtwmMG01xfs7iJPJxLwKTryetbsjG+uWbCECYdzVWQHjYMFRiYxQ7YnragUWxHS/7SbS5mVeXDaZhKBtlbPaYILYBXEEX7DQY98Yi0LdIZnwPdiR1sHl8BA+gVF7rlu7/moSvbLTyZtaf1PW0m8v/4gWWaGN7RmYz3u1M145gESxcRUh1wqSrU6+OZ0BdlpSOk+m0SpGQXtQ/vSuTmiAhng7oSdAitCqqdvzN288pS5d7iVzjZfsEY8aWfhdJIMT4L4A63KTBAe616+MeTjmZXYmpB7oRyZ82XmodiqhHKp8lV4T3gmEyo/KDCqF67niea2YWbzzxLsUEWn1g+ffvY11QEXF6RG2Y3lBVrJC8EFZaOST26Qs9mXjgYk6AmbRVUTTVYE37wuCWmClGT2ZFfOavjYmjcMr6MA2wJBWmgThOoOM8msjgCi3my74Tmi3AiAmmKWWJazitX5ZMLK1Xj+I2hR12gYAAkHFGFCl/3gFe9wIetxpb9vdVL6nPVCivq1YRrKCZ+v1ArhUv348VHRsK8fazLGsCTzY8xMCxj3/JhDXOTd/1/DnITixo+JG+PFQwIelutv/DO74ujEgK9t7q9JOi5lEBAfP01FMSC/pVjs86hX2NXx19coOc6oK8b+kUSXlx5is=

after_deploy:
  - heroku run "mix ecto.migrate" -a shorten-url-ba
